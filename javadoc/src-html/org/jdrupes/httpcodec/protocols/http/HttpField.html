<!DOCTYPE HTML>
<html lang="de">
<head>
<!-- Generated by javadoc (17) -->
<title>Source code</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="source: package: org.jdrupes.httpcodec.protocols.http, class: HttpField">
<meta name="generator" content="javadoc/SourceToHTMLConverter">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
</head>
<body class="source-page">
<main role="main">
<div class="source-container">
<pre><span class="source-line-no">001</span><span id="line-1">/*</span>
<span class="source-line-no">002</span><span id="line-2"> * This file is part of the JDrupes non-blocking HTTP Codec</span>
<span class="source-line-no">003</span><span id="line-3"> * Copyright (C) 2016, 2017  Michael N. Lipp</span>
<span class="source-line-no">004</span><span id="line-4"> *</span>
<span class="source-line-no">005</span><span id="line-5"> * This program is free software; you can redistribute it and/or modify it </span>
<span class="source-line-no">006</span><span id="line-6"> * under the terms of the GNU Lesser General Public License as published</span>
<span class="source-line-no">007</span><span id="line-7"> * by the Free Software Foundation; either version 3 of the License, or </span>
<span class="source-line-no">008</span><span id="line-8"> * (at your option) any later version.</span>
<span class="source-line-no">009</span><span id="line-9"> *</span>
<span class="source-line-no">010</span><span id="line-10"> * This program is distributed in the hope that it will be useful, but </span>
<span class="source-line-no">011</span><span id="line-11"> * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY</span>
<span class="source-line-no">012</span><span id="line-12"> * or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public </span>
<span class="source-line-no">013</span><span id="line-13"> * License for more details.</span>
<span class="source-line-no">014</span><span id="line-14"> *</span>
<span class="source-line-no">015</span><span id="line-15"> * You should have received a copy of the GNU Lesser General Public License along </span>
<span class="source-line-no">016</span><span id="line-16"> * with this program; if not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="source-line-no">017</span><span id="line-17"> */</span>
<span class="source-line-no">018</span><span id="line-18"></span>
<span class="source-line-no">019</span><span id="line-19">package org.jdrupes.httpcodec.protocols.http;</span>
<span class="source-line-no">020</span><span id="line-20"></span>
<span class="source-line-no">021</span><span id="line-21">import java.text.ParseException;</span>
<span class="source-line-no">022</span><span id="line-22">import java.util.Map;</span>
<span class="source-line-no">023</span><span id="line-23">import java.util.TreeMap;</span>
<span class="source-line-no">024</span><span id="line-24">import java.util.regex.Matcher;</span>
<span class="source-line-no">025</span><span id="line-25">import java.util.regex.Pattern;</span>
<span class="source-line-no">026</span><span id="line-26"></span>
<span class="source-line-no">027</span><span id="line-27">import static org.jdrupes.httpcodec.protocols.http.HttpConstants.*;</span>
<span class="source-line-no">028</span><span id="line-28"></span>
<span class="source-line-no">029</span><span id="line-29">import org.jdrupes.httpcodec.types.Converter;</span>
<span class="source-line-no">030</span><span id="line-30">import org.jdrupes.httpcodec.types.Converters;</span>
<span class="source-line-no">031</span><span id="line-31"></span>
<span class="source-line-no">032</span><span id="line-32">/**</span>
<span class="source-line-no">033</span><span id="line-33"> * A base class for all kinds of header field values.</span>
<span class="source-line-no">034</span><span id="line-34"> * </span>
<span class="source-line-no">035</span><span id="line-35"> * @param &lt;T&gt; the type of the header field's value </span>
<span class="source-line-no">036</span><span id="line-36"> * </span>
<span class="source-line-no">037</span><span id="line-37"> * @see "[Message Headers](https://www.iana.org/assignments/message-headers/message-headers.xhtml)"</span>
<span class="source-line-no">038</span><span id="line-38"> */</span>
<span class="source-line-no">039</span><span id="line-39">public class HttpField&lt;T&gt; {</span>
<span class="source-line-no">040</span><span id="line-40"></span>
<span class="source-line-no">041</span><span id="line-41">    // RFC 7230 3.2, 3.2.4</span>
<span class="source-line-no">042</span><span id="line-42">    protected static final Pattern headerLinePatter = Pattern</span>
<span class="source-line-no">043</span><span id="line-43">        .compile("^(" + TOKEN_REGEXP + "):(.*)$");</span>
<span class="source-line-no">044</span><span id="line-44"></span>
<span class="source-line-no">045</span><span id="line-45">    /** @see "[RFC 7231, 5.3.2](https://tools.ietf.org/html/rfc7231#section-5.3.2)" */</span>
<span class="source-line-no">046</span><span id="line-46">    public static final String ACCEPT = "Accept";</span>
<span class="source-line-no">047</span><span id="line-47">    /** @see "[RFC 7231, 5.3.3](https://tools.ietf.org/html/rfc7231#section-5.3.3)" */</span>
<span class="source-line-no">048</span><span id="line-48">    public static final String ACCEPT_CHARSET = "Accept-Charset";</span>
<span class="source-line-no">049</span><span id="line-49">    /** @see "[RFC 7231, 5.3.4](https://tools.ietf.org/html/rfc7231#section-5.3.4)" */</span>
<span class="source-line-no">050</span><span id="line-50">    public static final String ACCEPT_ENCODING = "Accept-Encoding";</span>
<span class="source-line-no">051</span><span id="line-51">    /** @see "[RFC 7231, 5.3.5](https://tools.ietf.org/html/rfc7231#section-5.3.5)" */</span>
<span class="source-line-no">052</span><span id="line-52">    public static final String ACCEPT_LANGUAGE = "Accept-Language";</span>
<span class="source-line-no">053</span><span id="line-53">    /** @see "[RFC 7234, 5.1](https://tools.ietf.org/html/rfc7234#section-5.1)" */</span>
<span class="source-line-no">054</span><span id="line-54">    public static final String AGE = "Age";</span>
<span class="source-line-no">055</span><span id="line-55">    /** @see "[RFC 7231, 7.4.1](https://tools.ietf.org/html/rfc7231#section-7.4.1)" */</span>
<span class="source-line-no">056</span><span id="line-56">    public static final String ALLOW = "Allow";</span>
<span class="source-line-no">057</span><span id="line-57">    /** @see "[RFC 7235, 4.2](https://tools.ietf.org/html/rfc7235#section-4.2)" */</span>
<span class="source-line-no">058</span><span id="line-58">    public static final String AUTHORIZATION = "Authorization";</span>
<span class="source-line-no">059</span><span id="line-59">    /** @see "[RFC 7234, 5.2](https://tools.ietf.org/html/rfc7234#section-5.2)" */</span>
<span class="source-line-no">060</span><span id="line-60">    public static final String CACHE_CONTROL = "Cache-Control";</span>
<span class="source-line-no">061</span><span id="line-61">    /** @see "[RFC 6265, 5.4](https://tools.ietf.org/html/rfc6265#section-5.4)" */</span>
<span class="source-line-no">062</span><span id="line-62">    public static final String COOKIE = "Cookie";</span>
<span class="source-line-no">063</span><span id="line-63">    /** @see "[RFC 7230, 6.1](https://tools.ietf.org/html/rfc7230#section-6.1)" */</span>
<span class="source-line-no">064</span><span id="line-64">    public static final String CONNECTION = "Connection";</span>
<span class="source-line-no">065</span><span id="line-65">    /** @see "[RFC 7230, 3.3.2](https://tools.ietf.org/html/rfc7230#section-3.3.2)" */</span>
<span class="source-line-no">066</span><span id="line-66">    public static final String CONTENT_LENGTH = "Content-Length";</span>
<span class="source-line-no">067</span><span id="line-67">    /** @see "[RFC 7231, 3.1.4.2](https://tools.ietf.org/html/rfc7231#section-3.1.4.2)" */</span>
<span class="source-line-no">068</span><span id="line-68">    public static final String CONTENT_LOCATION = "Content-Location";</span>
<span class="source-line-no">069</span><span id="line-69">    /** @see "[RFC 7231, 3.1.1.5](https://tools.ietf.org/html/rfc7231#section-3.1.1.5)" */</span>
<span class="source-line-no">070</span><span id="line-70">    public static final String CONTENT_TYPE = "Content-Type";</span>
<span class="source-line-no">071</span><span id="line-71">    /** @see "[RFC 7231, 7.1.1.2](https://tools.ietf.org/html/rfc7231#section-7.1.1.2)" */</span>
<span class="source-line-no">072</span><span id="line-72">    public static final String DATE = "Date";</span>
<span class="source-line-no">073</span><span id="line-73">    /** @see "[RFC 7232, 2.3](https://tools.ietf.org/html/rfc7232#section-2.3)" */</span>
<span class="source-line-no">074</span><span id="line-74">    public static final String ETAG = "ETag";</span>
<span class="source-line-no">075</span><span id="line-75">    /** @see "[RFC 7231, 5.1.1](https://tools.ietf.org/html/rfc7231#section-5.1.1)" */</span>
<span class="source-line-no">076</span><span id="line-76">    public static final String EXPECT = "Expect";</span>
<span class="source-line-no">077</span><span id="line-77">    /** @see "[RFC 7234, 5.3](https://tools.ietf.org/html/rfc7234#section-5.3)" */</span>
<span class="source-line-no">078</span><span id="line-78">    public static final String EXPIRES = "Expires";</span>
<span class="source-line-no">079</span><span id="line-79">    /** @see "[RFC 7231, 5.5.1](https://tools.ietf.org/html/rfc7231#section-5.5.1)" */</span>
<span class="source-line-no">080</span><span id="line-80">    public static final String FROM = "From";</span>
<span class="source-line-no">081</span><span id="line-81">    /** @see "[RFC 7230, 5.4](https://tools.ietf.org/html/rfc7230#section-5.4)" */</span>
<span class="source-line-no">082</span><span id="line-82">    public static final String HOST = "Host";</span>
<span class="source-line-no">083</span><span id="line-83">    /** @see "[RFC 7232, 3.1](https://tools.ietf.org/html/rfc7232#section-3.1)" */</span>
<span class="source-line-no">084</span><span id="line-84">    public static final String IF_MATCH = "If-Match";</span>
<span class="source-line-no">085</span><span id="line-85">    /** @see "[RFC 7232, 3.2](https://tools.ietf.org/html/rfc7232#section-3.2)" */</span>
<span class="source-line-no">086</span><span id="line-86">    public static final String IF_NONE_MATCH = "If-None-Match";</span>
<span class="source-line-no">087</span><span id="line-87">    /** @see "[RFC 7232, 3.3](https://tools.ietf.org/html/rfc7232#section-3.3)" */</span>
<span class="source-line-no">088</span><span id="line-88">    public static final String IF_MODIFIED_SINCE = "If-Modified-Since";</span>
<span class="source-line-no">089</span><span id="line-89">    /** @see "[RFC 7232, 3.4](https://tools.ietf.org/html/rfc7232#section-3.4)" */</span>
<span class="source-line-no">090</span><span id="line-90">    public static final String IF_UNMODIFIED_SINCE = "If-Unmodified-Since";</span>
<span class="source-line-no">091</span><span id="line-91">    /** @see "[RFC 7232, 2.2](https://tools.ietf.org/html/rfc7232#section-2.2)" */</span>
<span class="source-line-no">092</span><span id="line-92">    public static final String LAST_MODIFIED = "Last-Modified";</span>
<span class="source-line-no">093</span><span id="line-93">    /** @see "[RFC 7231, 7.1.2](https://tools.ietf.org/html/rfc7231#section-7.1.2)" */</span>
<span class="source-line-no">094</span><span id="line-94">    public static final String LOCATION = "Location";</span>
<span class="source-line-no">095</span><span id="line-95">    /** @see "[RFC 7231, 5.1.2](https://tools.ietf.org/html/rfc7231#section-5.1.2)" */</span>
<span class="source-line-no">096</span><span id="line-96">    public static final String MAX_FORWARDS = "Max-Forwards";</span>
<span class="source-line-no">097</span><span id="line-97">    /** @see "[RFC 7234, 5.4](https://tools.ietf.org/html/rfc7234#section-5.4)" */</span>
<span class="source-line-no">098</span><span id="line-98">    public static final String PRAGMA = "Pragma";</span>
<span class="source-line-no">099</span><span id="line-99">    /** @see "[RFC 7235, 4.3](https://tools.ietf.org/html/rfc7235#section-4.3)" */</span>
<span class="source-line-no">100</span><span id="line-100">    public static final String PROXY_AUTHENTICATE = "Proxy-Authenticate";</span>
<span class="source-line-no">101</span><span id="line-101">    /** @see "[RFC 7235, 4.4](https://tools.ietf.org/html/rfc7235#section-4.4)" */</span>
<span class="source-line-no">102</span><span id="line-102">    public static final String PROXY_AUTHORIZATION = "Proxy-Authorization";</span>
<span class="source-line-no">103</span><span id="line-103">    /** @see "[RFC 7231, 7.1.3](https://tools.ietf.org/html/rfc7231#section-7.1.3)" */</span>
<span class="source-line-no">104</span><span id="line-104">    public static final String RETRY_AFTER = "Retry-After";</span>
<span class="source-line-no">105</span><span id="line-105">    /** @see "[RFC 7231, 7.4.2](https://tools.ietf.org/html/rfc7231#section-7.4.2)" */</span>
<span class="source-line-no">106</span><span id="line-106">    public static final String SERVER = "Server";</span>
<span class="source-line-no">107</span><span id="line-107">    /** @see "[RFC 6265, 4.1.1](https://tools.ietf.org/html/rfc6265#section-4.1.1)" */</span>
<span class="source-line-no">108</span><span id="line-108">    public static final String SET_COOKIE = "Set-Cookie";</span>
<span class="source-line-no">109</span><span id="line-109">    /** @see "[RFC 7230, 4.3](https://tools.ietf.org/html/rfc7230#section-4.3)" */</span>
<span class="source-line-no">110</span><span id="line-110">    public static final String TE = "TE";</span>
<span class="source-line-no">111</span><span id="line-111">    /** @see "[RFC 7230, 4.4](https://tools.ietf.org/html/rfc7230#section-4.4)" */</span>
<span class="source-line-no">112</span><span id="line-112">    public static final String TRAILER = "Trailer";</span>
<span class="source-line-no">113</span><span id="line-113">    /** @see "[RFC 7230, 3.3.1](https://tools.ietf.org/html/rfc7230#section-3.3.1)" */</span>
<span class="source-line-no">114</span><span id="line-114">    public static final String TRANSFER_ENCODING = "Transfer-Encoding";</span>
<span class="source-line-no">115</span><span id="line-115">    /** @see "[RFC 7230, 6.7](https://tools.ietf.org/html/rfc7230#section-6.7)" */</span>
<span class="source-line-no">116</span><span id="line-116">    public static final String UPGRADE = "Upgrade";</span>
<span class="source-line-no">117</span><span id="line-117">    /** @see "[RFC 7231, 5.5.3](https://tools.ietf.org/html/rfc7231#section-5.5.3)" */</span>
<span class="source-line-no">118</span><span id="line-118">    public static final String USER_AGENT = "User-Agent";</span>
<span class="source-line-no">119</span><span id="line-119">    /** @see "[RFC 7231, 7.1.4](https://tools.ietf.org/html/rfc7231#section-7.1.4)" */</span>
<span class="source-line-no">120</span><span id="line-120">    public static final String VARY = "Vary";</span>
<span class="source-line-no">121</span><span id="line-121">    /** @see "[RFC 7230, 5.7.1](https://tools.ietf.org/html/rfc7230#section-5.7.1)" */</span>
<span class="source-line-no">122</span><span id="line-122">    public static final String VIA = "Via";</span>
<span class="source-line-no">123</span><span id="line-123">    /** @see "[RFC 7234, 5.5](https://tools.ietf.org/html/rfc7234#section-5.5)" */</span>
<span class="source-line-no">124</span><span id="line-124">    public static final String WARNING = "Warning";</span>
<span class="source-line-no">125</span><span id="line-125">    /** @see "[RFC 7235, 4.1](https://tools.ietf.org/html/rfc7235#section-4.1)" */</span>
<span class="source-line-no">126</span><span id="line-126">    public static final String WWW_AUTHENTICATE = "WWW-Authenticate";</span>
<span class="source-line-no">127</span><span id="line-127"></span>
<span class="source-line-no">128</span><span id="line-128">    private static Map&lt;String, String&gt; fieldNameMap = new TreeMap&lt;&gt;(</span>
<span class="source-line-no">129</span><span id="line-129">        String.CASE_INSENSITIVE_ORDER);</span>
<span class="source-line-no">130</span><span id="line-130"></span>
<span class="source-line-no">131</span><span id="line-131">    static {</span>
<span class="source-line-no">132</span><span id="line-132">        fieldNameMap.put(ACCEPT, ACCEPT);</span>
<span class="source-line-no">133</span><span id="line-133">        fieldNameMap.put(ACCEPT_CHARSET, ACCEPT_CHARSET);</span>
<span class="source-line-no">134</span><span id="line-134">        fieldNameMap.put(ACCEPT_ENCODING, ACCEPT_ENCODING);</span>
<span class="source-line-no">135</span><span id="line-135">        fieldNameMap.put(ACCEPT_LANGUAGE, ACCEPT_LANGUAGE);</span>
<span class="source-line-no">136</span><span id="line-136">        fieldNameMap.put(AGE, AGE);</span>
<span class="source-line-no">137</span><span id="line-137">        fieldNameMap.put(ALLOW, ALLOW);</span>
<span class="source-line-no">138</span><span id="line-138">        fieldNameMap.put(AUTHORIZATION, AUTHORIZATION);</span>
<span class="source-line-no">139</span><span id="line-139">        fieldNameMap.put(CACHE_CONTROL, CACHE_CONTROL);</span>
<span class="source-line-no">140</span><span id="line-140">        fieldNameMap.put(COOKIE, COOKIE);</span>
<span class="source-line-no">141</span><span id="line-141">        fieldNameMap.put(CONNECTION, CONNECTION);</span>
<span class="source-line-no">142</span><span id="line-142">        fieldNameMap.put(CONTENT_LENGTH, CONTENT_LENGTH);</span>
<span class="source-line-no">143</span><span id="line-143">        fieldNameMap.put(CONTENT_LOCATION, CONTENT_LOCATION);</span>
<span class="source-line-no">144</span><span id="line-144">        fieldNameMap.put(CONTENT_TYPE, CONTENT_TYPE);</span>
<span class="source-line-no">145</span><span id="line-145">        fieldNameMap.put(DATE, DATE);</span>
<span class="source-line-no">146</span><span id="line-146">        fieldNameMap.put(ETAG, ETAG);</span>
<span class="source-line-no">147</span><span id="line-147">        fieldNameMap.put(EXPECT, EXPECT);</span>
<span class="source-line-no">148</span><span id="line-148">        fieldNameMap.put(EXPIRES, EXPIRES);</span>
<span class="source-line-no">149</span><span id="line-149">        fieldNameMap.put(FROM, FROM);</span>
<span class="source-line-no">150</span><span id="line-150">        fieldNameMap.put(HOST, HOST);</span>
<span class="source-line-no">151</span><span id="line-151">        fieldNameMap.put(IF_MATCH, IF_MATCH);</span>
<span class="source-line-no">152</span><span id="line-152">        fieldNameMap.put(IF_NONE_MATCH, IF_NONE_MATCH);</span>
<span class="source-line-no">153</span><span id="line-153">        fieldNameMap.put(IF_MODIFIED_SINCE, IF_MODIFIED_SINCE);</span>
<span class="source-line-no">154</span><span id="line-154">        fieldNameMap.put(IF_UNMODIFIED_SINCE, IF_UNMODIFIED_SINCE);</span>
<span class="source-line-no">155</span><span id="line-155">        fieldNameMap.put(LAST_MODIFIED, LAST_MODIFIED);</span>
<span class="source-line-no">156</span><span id="line-156">        fieldNameMap.put(LOCATION, LOCATION);</span>
<span class="source-line-no">157</span><span id="line-157">        fieldNameMap.put(MAX_FORWARDS, MAX_FORWARDS);</span>
<span class="source-line-no">158</span><span id="line-158">        fieldNameMap.put(PRAGMA, PRAGMA);</span>
<span class="source-line-no">159</span><span id="line-159">        fieldNameMap.put(PROXY_AUTHENTICATE, PROXY_AUTHENTICATE);</span>
<span class="source-line-no">160</span><span id="line-160">        fieldNameMap.put(PROXY_AUTHORIZATION, PROXY_AUTHORIZATION);</span>
<span class="source-line-no">161</span><span id="line-161">        fieldNameMap.put(RETRY_AFTER, RETRY_AFTER);</span>
<span class="source-line-no">162</span><span id="line-162">        fieldNameMap.put(SERVER, SERVER);</span>
<span class="source-line-no">163</span><span id="line-163">        fieldNameMap.put(SET_COOKIE, SET_COOKIE);</span>
<span class="source-line-no">164</span><span id="line-164">        fieldNameMap.put(TE, TE);</span>
<span class="source-line-no">165</span><span id="line-165">        fieldNameMap.put(TRAILER, TRAILER);</span>
<span class="source-line-no">166</span><span id="line-166">        fieldNameMap.put(TRANSFER_ENCODING, TRANSFER_ENCODING);</span>
<span class="source-line-no">167</span><span id="line-167">        fieldNameMap.put(UPGRADE, UPGRADE);</span>
<span class="source-line-no">168</span><span id="line-168">        fieldNameMap.put(USER_AGENT, USER_AGENT);</span>
<span class="source-line-no">169</span><span id="line-169">        fieldNameMap.put(VARY, VARY);</span>
<span class="source-line-no">170</span><span id="line-170">        fieldNameMap.put(VIA, VIA);</span>
<span class="source-line-no">171</span><span id="line-171">        fieldNameMap.put(WARNING, WARNING);</span>
<span class="source-line-no">172</span><span id="line-172">        fieldNameMap.put(WWW_AUTHENTICATE, WWW_AUTHENTICATE);</span>
<span class="source-line-no">173</span><span id="line-173">    }</span>
<span class="source-line-no">174</span><span id="line-174"></span>
<span class="source-line-no">175</span><span id="line-175">    private final String name;</span>
<span class="source-line-no">176</span><span id="line-176">    private T value;</span>
<span class="source-line-no">177</span><span id="line-177">    private Converter&lt;T&gt; converter;</span>
<span class="source-line-no">178</span><span id="line-178"></span>
<span class="source-line-no">179</span><span id="line-179">    /**</span>
<span class="source-line-no">180</span><span id="line-180">     * Creates a new representation of a header field with the </span>
<span class="source-line-no">181</span><span id="line-181">     * given value and converter. For fields with a </span>
<span class="source-line-no">182</span><span id="line-182">     * constant definition in this class, the name is normalized.</span>
<span class="source-line-no">183</span><span id="line-183">     * </span>
<span class="source-line-no">184</span><span id="line-184">     * @param name the field name</span>
<span class="source-line-no">185</span><span id="line-185">     * @param value the value</span>
<span class="source-line-no">186</span><span id="line-186">     * @param converter the converter</span>
<span class="source-line-no">187</span><span id="line-187">     */</span>
<span class="source-line-no">188</span><span id="line-188">    public HttpField(String name, T value, Converter&lt;T&gt; converter) {</span>
<span class="source-line-no">189</span><span id="line-189">        this.name = fieldNameMap.getOrDefault(name, name);</span>
<span class="source-line-no">190</span><span id="line-190">        this.converter = converter;</span>
<span class="source-line-no">191</span><span id="line-191">        this.value = value;</span>
<span class="source-line-no">192</span><span id="line-192">    }</span>
<span class="source-line-no">193</span><span id="line-193"></span>
<span class="source-line-no">194</span><span id="line-194">    /**</span>
<span class="source-line-no">195</span><span id="line-195">     * Creates a new representation of a header field from its textual</span>
<span class="source-line-no">196</span><span id="line-196">     * representation. For fields with a </span>
<span class="source-line-no">197</span><span id="line-197">     * constant definition in this class, the name is normalized.</span>
<span class="source-line-no">198</span><span id="line-198">     * </span>
<span class="source-line-no">199</span><span id="line-199">     * @param headerLine the header line</span>
<span class="source-line-no">200</span><span id="line-200">     * @param converter the converter</span>
<span class="source-line-no">201</span><span id="line-201">     * @throws ParseException if an error occurs while parsing the header line</span>
<span class="source-line-no">202</span><span id="line-202">     */</span>
<span class="source-line-no">203</span><span id="line-203">    public HttpField(String headerLine, Converter&lt;T&gt; converter)</span>
<span class="source-line-no">204</span><span id="line-204">            throws ParseException {</span>
<span class="source-line-no">205</span><span id="line-205">        this.converter = converter;</span>
<span class="source-line-no">206</span><span id="line-206">        Matcher hlp = headerLinePatter.matcher(headerLine);</span>
<span class="source-line-no">207</span><span id="line-207">        if (!hlp.matches()) {</span>
<span class="source-line-no">208</span><span id="line-208">            throw new ParseException("Invalid header: ", 0);</span>
<span class="source-line-no">209</span><span id="line-209">        }</span>
<span class="source-line-no">210</span><span id="line-210">        this.name = fieldNameMap.getOrDefault(hlp.group(1), hlp.group(1));</span>
<span class="source-line-no">211</span><span id="line-211">        // RFC 7230 3.2.4</span>
<span class="source-line-no">212</span><span id="line-212">        this.value = converter.fromFieldValue(hlp.group(2).trim());</span>
<span class="source-line-no">213</span><span id="line-213">    }</span>
<span class="source-line-no">214</span><span id="line-214"></span>
<span class="source-line-no">215</span><span id="line-215">    /**</span>
<span class="source-line-no">216</span><span id="line-216">     * Returns the proper converter for the header field with the given</span>
<span class="source-line-no">217</span><span id="line-217">     * name. Works for all well known</span>
<span class="source-line-no">218</span><span id="line-218">     * field names, i.e. the field names defined as constants in this class.</span>
<span class="source-line-no">219</span><span id="line-219">     * If the field name is unknown, a string converter is returned.</span>
<span class="source-line-no">220</span><span id="line-220">     * </span>
<span class="source-line-no">221</span><span id="line-221">     * @param fieldName</span>
<span class="source-line-no">222</span><span id="line-222">     *            the field name</span>
<span class="source-line-no">223</span><span id="line-223">     * @return the converter</span>
<span class="source-line-no">224</span><span id="line-224">     */</span>
<span class="source-line-no">225</span><span id="line-225">    public static Converter&lt;?&gt; lookupConverter(String fieldName) {</span>
<span class="source-line-no">226</span><span id="line-226">        String normalizedFieldName = fieldNameMap</span>
<span class="source-line-no">227</span><span id="line-227">            .getOrDefault(fieldName, fieldName);</span>
<span class="source-line-no">228</span><span id="line-228">        switch (normalizedFieldName) {</span>
<span class="source-line-no">229</span><span id="line-229">        case ACCEPT:</span>
<span class="source-line-no">230</span><span id="line-230">            return Converters.MEDIA_RANGE;</span>
<span class="source-line-no">231</span><span id="line-231">        case ACCEPT_LANGUAGE:</span>
<span class="source-line-no">232</span><span id="line-232">            return Converters.LANGUAGE;</span>
<span class="source-line-no">233</span><span id="line-233">        case AGE:</span>
<span class="source-line-no">234</span><span id="line-234">            return Converters.LONG;</span>
<span class="source-line-no">235</span><span id="line-235">        case ALLOW:</span>
<span class="source-line-no">236</span><span id="line-236">            return Converters.STRING_LIST;</span>
<span class="source-line-no">237</span><span id="line-237">        case AUTHORIZATION:</span>
<span class="source-line-no">238</span><span id="line-238">            return Converters.CREDENTIALS;</span>
<span class="source-line-no">239</span><span id="line-239">        case CACHE_CONTROL:</span>
<span class="source-line-no">240</span><span id="line-240">            return Converters.CACHE_CONTROL_LIST;</span>
<span class="source-line-no">241</span><span id="line-241">        case COOKIE:</span>
<span class="source-line-no">242</span><span id="line-242">            return Converters.COOKIE_LIST;</span>
<span class="source-line-no">243</span><span id="line-243">        case CONNECTION:</span>
<span class="source-line-no">244</span><span id="line-244">            return Converters.STRING_LIST;</span>
<span class="source-line-no">245</span><span id="line-245">        case CONTENT_LENGTH:</span>
<span class="source-line-no">246</span><span id="line-246">            return Converters.LONG;</span>
<span class="source-line-no">247</span><span id="line-247">        case CONTENT_LOCATION:</span>
<span class="source-line-no">248</span><span id="line-248">            return Converters.URI_CONV;</span>
<span class="source-line-no">249</span><span id="line-249">        case CONTENT_TYPE:</span>
<span class="source-line-no">250</span><span id="line-250">            return Converters.MEDIA_TYPE;</span>
<span class="source-line-no">251</span><span id="line-251">        case DATE:</span>
<span class="source-line-no">252</span><span id="line-252">            return Converters.DATE_TIME;</span>
<span class="source-line-no">253</span><span id="line-253">        case EXPIRES:</span>
<span class="source-line-no">254</span><span id="line-254">            return Converters.DATE_TIME;</span>
<span class="source-line-no">255</span><span id="line-255">        case HOST:</span>
<span class="source-line-no">256</span><span id="line-256">            return Converters.UNQUOTED_STRING;</span>
<span class="source-line-no">257</span><span id="line-257">        case IF_MATCH:</span>
<span class="source-line-no">258</span><span id="line-258">            return Converters.ETAG_LIST;</span>
<span class="source-line-no">259</span><span id="line-259">        case IF_MODIFIED_SINCE:</span>
<span class="source-line-no">260</span><span id="line-260">            return Converters.DATE_TIME;</span>
<span class="source-line-no">261</span><span id="line-261">        case IF_NONE_MATCH:</span>
<span class="source-line-no">262</span><span id="line-262">            return Converters.ETAG_LIST;</span>
<span class="source-line-no">263</span><span id="line-263">        case IF_UNMODIFIED_SINCE:</span>
<span class="source-line-no">264</span><span id="line-264">            return Converters.DATE_TIME;</span>
<span class="source-line-no">265</span><span id="line-265">        case LAST_MODIFIED:</span>
<span class="source-line-no">266</span><span id="line-266">            return Converters.DATE_TIME;</span>
<span class="source-line-no">267</span><span id="line-267">        case LOCATION:</span>
<span class="source-line-no">268</span><span id="line-268">            return Converters.URI_CONV;</span>
<span class="source-line-no">269</span><span id="line-269">        case MAX_FORWARDS:</span>
<span class="source-line-no">270</span><span id="line-270">            return Converters.LONG;</span>
<span class="source-line-no">271</span><span id="line-271">        case PRAGMA:</span>
<span class="source-line-no">272</span><span id="line-272">            return Converters.DIRECTIVE_LIST;</span>
<span class="source-line-no">273</span><span id="line-273">        case PROXY_AUTHENTICATE:</span>
<span class="source-line-no">274</span><span id="line-274">            return Converters.CHALLENGE_LIST;</span>
<span class="source-line-no">275</span><span id="line-275">        case PROXY_AUTHORIZATION:</span>
<span class="source-line-no">276</span><span id="line-276">            return Converters.CREDENTIALS;</span>
<span class="source-line-no">277</span><span id="line-277">        case RETRY_AFTER:</span>
<span class="source-line-no">278</span><span id="line-278">            return Converters.DATE_TIME;</span>
<span class="source-line-no">279</span><span id="line-279">        case SERVER:</span>
<span class="source-line-no">280</span><span id="line-280">            return Converters.PRODUCT_DESCRIPTIONS;</span>
<span class="source-line-no">281</span><span id="line-281">        case SET_COOKIE:</span>
<span class="source-line-no">282</span><span id="line-282">            return Converters.SET_COOKIE;</span>
<span class="source-line-no">283</span><span id="line-283">        case TRAILER:</span>
<span class="source-line-no">284</span><span id="line-284">            return Converters.STRING_LIST;</span>
<span class="source-line-no">285</span><span id="line-285">        case TRANSFER_ENCODING:</span>
<span class="source-line-no">286</span><span id="line-286">            return Converters.STRING_LIST;</span>
<span class="source-line-no">287</span><span id="line-287">        case UPGRADE:</span>
<span class="source-line-no">288</span><span id="line-288">            return Converters.STRING_LIST;</span>
<span class="source-line-no">289</span><span id="line-289">        case USER_AGENT:</span>
<span class="source-line-no">290</span><span id="line-290">            return Converters.PRODUCT_DESCRIPTIONS;</span>
<span class="source-line-no">291</span><span id="line-291">        case VIA:</span>
<span class="source-line-no">292</span><span id="line-292">            return Converters.STRING_LIST;</span>
<span class="source-line-no">293</span><span id="line-293">        case WARNING:</span>
<span class="source-line-no">294</span><span id="line-294">            return Converters.STRING;</span>
<span class="source-line-no">295</span><span id="line-295">        case WWW_AUTHENTICATE:</span>
<span class="source-line-no">296</span><span id="line-296">            return Converters.CHALLENGE_LIST;</span>
<span class="source-line-no">297</span><span id="line-297">        default:</span>
<span class="source-line-no">298</span><span id="line-298">            return Converters.STRING;</span>
<span class="source-line-no">299</span><span id="line-299">        }</span>
<span class="source-line-no">300</span><span id="line-300">    }</span>
<span class="source-line-no">301</span><span id="line-301"></span>
<span class="source-line-no">302</span><span id="line-302">    /**</span>
<span class="source-line-no">303</span><span id="line-303">     * Returns the header field name.</span>
<span class="source-line-no">304</span><span id="line-304">     * </span>
<span class="source-line-no">305</span><span id="line-305">     * @return the name</span>
<span class="source-line-no">306</span><span id="line-306">     */</span>
<span class="source-line-no">307</span><span id="line-307">    public String name() {</span>
<span class="source-line-no">308</span><span id="line-308">        return name;</span>
<span class="source-line-no">309</span><span id="line-309">    }</span>
<span class="source-line-no">310</span><span id="line-310"></span>
<span class="source-line-no">311</span><span id="line-311">    /**</span>
<span class="source-line-no">312</span><span id="line-312">     * Returns the header field's parsed value.</span>
<span class="source-line-no">313</span><span id="line-313">     * </span>
<span class="source-line-no">314</span><span id="line-314">     * @return the field's value</span>
<span class="source-line-no">315</span><span id="line-315">     */</span>
<span class="source-line-no">316</span><span id="line-316">    public T value() {</span>
<span class="source-line-no">317</span><span id="line-317">        return value;</span>
<span class="source-line-no">318</span><span id="line-318">    }</span>
<span class="source-line-no">319</span><span id="line-319"></span>
<span class="source-line-no">320</span><span id="line-320">    /**</span>
<span class="source-line-no">321</span><span id="line-321">     * Returns the cconverter used by this field.</span>
<span class="source-line-no">322</span><span id="line-322">     * </span>
<span class="source-line-no">323</span><span id="line-323">     * @return the converter</span>
<span class="source-line-no">324</span><span id="line-324">     */</span>
<span class="source-line-no">325</span><span id="line-325">    public Converter&lt;T&gt; converter() {</span>
<span class="source-line-no">326</span><span id="line-326">        return converter;</span>
<span class="source-line-no">327</span><span id="line-327">    }</span>
<span class="source-line-no">328</span><span id="line-328"></span>
<span class="source-line-no">329</span><span id="line-329">    /**</span>
<span class="source-line-no">330</span><span id="line-330">     * Sets the header field's value.</span>
<span class="source-line-no">331</span><span id="line-331">     * </span>
<span class="source-line-no">332</span><span id="line-332">     * @param value the new value</span>
<span class="source-line-no">333</span><span id="line-333">     * @return the field for easy chaining</span>
<span class="source-line-no">334</span><span id="line-334">     */</span>
<span class="source-line-no">335</span><span id="line-335">    public HttpField&lt;T&gt; setValue(T value) {</span>
<span class="source-line-no">336</span><span id="line-336">        this.value = value;</span>
<span class="source-line-no">337</span><span id="line-337">        return this;</span>
<span class="source-line-no">338</span><span id="line-338">    }</span>
<span class="source-line-no">339</span><span id="line-339"></span>
<span class="source-line-no">340</span><span id="line-340">    /**</span>
<span class="source-line-no">341</span><span id="line-341">     * Returns the string representation of this field's value.</span>
<span class="source-line-no">342</span><span id="line-342">     * </span>
<span class="source-line-no">343</span><span id="line-343">     * @return the field value as string</span>
<span class="source-line-no">344</span><span id="line-344">     */</span>
<span class="source-line-no">345</span><span id="line-345">    public String asFieldValue() {</span>
<span class="source-line-no">346</span><span id="line-346">        return converter.asFieldValue(value);</span>
<span class="source-line-no">347</span><span id="line-347">    }</span>
<span class="source-line-no">348</span><span id="line-348"></span>
<span class="source-line-no">349</span><span id="line-349">    /**</span>
<span class="source-line-no">350</span><span id="line-350">     * Returns the string representation of this header field as it appears in</span>
<span class="source-line-no">351</span><span id="line-351">     * an HTTP message. Note that the returned string may span several</span>
<span class="source-line-no">352</span><span id="line-352">     * lines (may contain CR/LF), but is has no trailing CR/LF.</span>
<span class="source-line-no">353</span><span id="line-353">     * </span>
<span class="source-line-no">354</span><span id="line-354">     * @return the field as it occurs in a header</span>
<span class="source-line-no">355</span><span id="line-355">     */</span>
<span class="source-line-no">356</span><span id="line-356">    public String asHeaderField() {</span>
<span class="source-line-no">357</span><span id="line-357">        return converter.asHeaderField(name(), value);</span>
<span class="source-line-no">358</span><span id="line-358">    }</span>
<span class="source-line-no">359</span><span id="line-359"></span>
<span class="source-line-no">360</span><span id="line-360">    /*</span>
<span class="source-line-no">361</span><span id="line-361">     * (non-Javadoc)</span>
<span class="source-line-no">362</span><span id="line-362">     * </span>
<span class="source-line-no">363</span><span id="line-363">     * @see java.lang.Object#toString()</span>
<span class="source-line-no">364</span><span id="line-364">     */</span>
<span class="source-line-no">365</span><span id="line-365">    @Override</span>
<span class="source-line-no">366</span><span id="line-366">    public String toString() {</span>
<span class="source-line-no">367</span><span id="line-367">        StringBuilder result = new StringBuilder();</span>
<span class="source-line-no">368</span><span id="line-368">        result.append(getClass().getSimpleName());</span>
<span class="source-line-no">369</span><span id="line-369">        result.append(" [");</span>
<span class="source-line-no">370</span><span id="line-370">        result.append(asHeaderField().replace("\r\n", " CRLF "));</span>
<span class="source-line-no">371</span><span id="line-371">        result.append("]");</span>
<span class="source-line-no">372</span><span id="line-372">        return result.toString();</span>
<span class="source-line-no">373</span><span id="line-373">    }</span>
<span class="source-line-no">374</span><span id="line-374">}</span>




























































</pre>
</div>
</main>
</body>
</html>
